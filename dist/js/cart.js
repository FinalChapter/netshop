"use strict";$(function(){var t=getCookie("nickname");if(!t)return window.location.href="../html/login.html";$(".apply").on("click",function(){window.location.href="../html/register.html"}),t&&($(".user-login-in").html("欢迎！ ".concat(t,'<ul class="hide"><li>退出登录</li></li>')),$(".user-login-in").on("click",function(){$(".user-login-in>ul").toggleClass("hide")}),$(".user-login-in>ul").on("click",function(){setCookie("nickname","",-1),window.location.href="../html/index.html"}));var i,c=JSON.parse(window.localStorage.getItem("cart"))||[];if(!c.length)return $(".no-goods").removeClass("hide"),void $(".main-info").addClass("hide");function o(){if(!c.length)return window.location.reload();var t=c.every(function(t){return 1==t.is_select}),n=0,i=0;c.forEach(function(t){1==t.is_select&&(n+=+t.cart_number,i+=t.cart_number*t.goods_price)});var o='\n        <ul class="table-head">\n        <li class="selectAll"><input type="checkbox" '.concat(t?"checked":"",'>全选</li>\n        <li>商品</li>\n       <li>属性</li>\n       <li>单价</li>\n       <li>数量</li>\n       <li>小计</li>\n        <li>操作</li>\n   </ul> \n   <h4>360商城直营</h4>\n   <p><span>满赠</span> 还差201元，可领取赠品1件 去凑单 ></p>\n   <ol class="tab-body">');c.forEach(function(t){o+='<li>\n          <div class="goods-check select"><input type="checkbox" data-id="'.concat(t.goods_id,'" type="checkbox" ').concat(1==t.is_select?"checked":"",'></div>\n          <div class="goods-name">\n              <img src="').concat(t.goods_small_logo,'" alt="">\n              <p>').concat(t.goods_name,'</p>\n          </div>\n          <div class="goods-type">黑色</div>\n          <div class="price">￥').concat(t.goods_price,'</div>\n          <div class="goods-number count"><p><span class="subNum" data-id="').concat(t.goods_id,'">-</span><input type="text" data-id="').concat(t.goods_id,'" value="').concat(t.cart_number,'"><span class="addNum" data-id="').concat(t.goods_id,'">+</span></p> </div>\n          <div class="xiaoji">￥').concat((t.goods_price*t.cart_number).toFixed(2),'</div>\n          <div class="operate"><span class="del" data-id="').concat(t.goods_id,'">删除</span></div>\n      </li>')}),o+='\n   </ol>\n  <div class="tab-foot">\n      <div class="tab-foot-left">\n          <div class="check-all selectAll">\n              <input type="checkbox" '.concat(t?"checked":"",'>全选\n          </div>\n          <span class="clearCart">删除所有商品</span>\n      </div>\n      <div class="tab-foot-right">\n          <div>\n            <span> 已选<span class="total-num">').concat(n,'件</span>商品</span><i class="total-price">合计：¥').concat(i.toFixed(2),'元</i>\n            <p>已优惠：￥0.00</p>\n            </div>\n            <button class="').concat(0===n?"":"active",'" ').concat(0===n?"disabled":"",'>去结算</button>\n            <button class="go-list">去继续购物</button>\n        </div>\n   </div>'),$(".cart-info").html(o)}$(".main-info").removeClass("hide"),$(".no-goods").addClass("hide"),o(),$(".cart-info").on("click",".select > input",function(){var n=this;c.filter(function(t){return t.goods_id==$(n).attr("data-id")})[0].is_select=this.checked?1:0,o(),window.localStorage.setItem("cart",JSON.stringify(c))}),$(".cart-info").on("click",".count  .subNum",function(){var n=this,t=c.filter(function(t){return t.goods_id==$(n).attr("data-id")})[0];1<t.cart_number&&t.cart_number--,o(),window.localStorage.setItem("cart",JSON.stringify(c))}),$(".cart-info").on("click",".count  .addNum",function(){var n=this;c.filter(function(t){return t.goods_id==$(n).attr("data-id")})[0].cart_number++,o(),window.localStorage.setItem("cart",JSON.stringify(c))}),$(".cart-info").on("click",".operate  > .del",function(){var i=this;c.forEach(function(t,n){t.goods_id==$(i).attr("data-id")&&c.splice(n,1)}),o(),window.localStorage.setItem("cart",JSON.stringify(c))}),$(".cart-info").on("mouseleave",".count input",function(){var n=this;0<+$(this).val()?(c.filter(function(t){return t.goods_id==$(n).attr("data-id")})[0].cart_number=+$(this).val(),o(),window.localStorage.setItem("cart",JSON.stringify(c))):o()}),$(".cart-info").on("click",".selectAll > input",function(){this.checked?c.forEach(function(t){t.is_select=1}):c.forEach(function(t){t.is_select=0}),o(),window.localStorage.setItem("cart",JSON.stringify(c))}),$(".cart-info").on("click",".tab-foot  .clearCart",function(){window.localStorage.removeItem("cart"),window.location.reload()}),$(".cart-info").on("click",".tab-foot-right > .go-list",function(){window.location.href="../html/list.html"}),i=$(".searchbox ol")[0],$(".searchbox .searchInp")[0].addEventListener("input",function(){var t,n;(value=this.value.trim())?(t="https://www.baidu.com/sugrec?pre=1&p=3&ie=utf-8&json=1&prod=pc&from=pc_web&sugsid=1446,32857,33124,33061,32973,33099,33101,32962,22159&wd=".concat(value,"&req=2&csor=1&cb=bindSearchHtml&_=1605768936993"),(n=document.createElement("script")).src=t,document.body.appendChild(n),n.remove()):$(i).addClass("hide")})});var value="";function bindSearchHtml(t){var n=$(".searchbox ol")[0];if(t.g&&value){for(var i=document.createDocumentFragment(),o=0;o<t.g.length;o++){var c=document.createElement("li");c.innerHTML=t.g[o].q,i.appendChild(c)}n.innerHTML="",n.appendChild(i),$(n).removeClass("hide")}else $(n).addClass("hide")}